# Zeffyr Music — LLM Context

Music streaming app — Angular 21, SSR, zoneless, OnPush, @ngrx/signals.

## Stack
- Angular 21.1.5 (SSR, standalone, zoneless via provideZonelessChangeDetection)
- @ngrx/signals 21.0.1 (Signal Stores for state management)
- Bootstrap 5.3.8 + ng-bootstrap 20 (UI framework)
- Transloco 8.2 + MessageFormat (i18n: fr/en)
- Vitest 4.x (unit tests), Cypress 15.x (E2E)
- Signal Forms (@angular/forms/signals) for forms
- YouTube IFrame API (music playback)

## Key Rules
- OnPush change detection on ALL components
- signal() for local state, computed() for derived — call as functions: this.value()
- inject() function only — no constructor injection
- readonly on all injected dependencies and signals
- styleUrl (singular) not styleUrls
- @if/@for/@switch control flow — not *ngIf/*ngFor
- English-only comments
- Vitest (not Jest/Jasmine)
- No any types — use proper typing
- No BehaviorSubject for shared state — use Signal Stores
- withSsrSafety() in stores — never access window/document directly

## Architecture
- 5 Signal Stores: AuthStore, PlayerStore, QueueStore, UserDataStore, UiStore
- 13 Services: HTTP calls + business logic only (no state)
- 4 Skeleton components: skeleton-card, skeleton-list, skeleton-artist, skeleton-playlist
- Empty state pattern: .empty-state + .empty-state-icon + .empty-state-text
- Modal alert system: .modal-alert + variants (-danger, -success, -warning, -info)
- Design system: CSS custom properties in _custom.scss (:root)
- Brand colors: $blue #1ac8e5 (primary), $orange #fc7e12 (accent)
- Font: Nunito (Regular/SemiBold/Bold/ExtraBold)

## Critical CSS Rule
YouTube #player styles MUST be in styles.scss (global) — iframe has no Angular encapsulation.
Mobile #player { height: 1px } MUST be global. See .github/instructions/css-critical-rules.md.

## Signal Forms + Transloco
Use arrow functions for validation messages (deferred evaluation):
  message: () => this.transloco.translate('key', { min: 4 })
NOT direct calls (evaluated before translations loaded).

## ng-bootstrap Accessibility
ng-bootstrap directives handle keyboard/ARIA automatically.
Do NOT add redundant tabindex, keydown, role on ngbDropdownToggle, ngbTooltip, etc.

## Commands
npm start — Dev server
npm test — Vitest watch
npx vitest run — Single run
npm run lint — ESLint
npm run build — Production build
